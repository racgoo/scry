import { useLayoutEffect, useState } from "react";
import type { TraceNode } from "../types/injection";
import { useTransformer } from "./useTransformer";

const dummy =
  "W1siMSIsIjIiLCIzIl0seyJwYXJlbnQiOm51bGwsImVycm9yZWQiOmZhbHNlLCJ0cmFjZUlkIjoxNywibmFtZSI6IjQiLCJzb3VyY2UiOiI1IiwiZnVuY3Rpb25Db2RlIjoiNiIsIm1ldGhvZENvZGUiOiI3IiwiY2xhc3NDb2RlIjoiNyIsImFyZ3MiOiI4IiwiY2hpbGRyZW4iOiI5IiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6bnVsbH0seyJwYXJlbnQiOm51bGwsImVycm9yZWQiOmZhbHNlLCJ0cmFjZUlkIjoyMCwibmFtZSI6IjEwIiwic291cmNlIjoiMTEiLCJmdW5jdGlvbkNvZGUiOiIxMiIsIm1ldGhvZENvZGUiOiI3IiwiY2xhc3NDb2RlIjoiNyIsImFyZ3MiOiIxMyIsImNoaWxkcmVuIjoiMTQiLCJjb21wbGV0ZWQiOnRydWUsImNoYWluZWQiOmZhbHNlLCJwYXJlbnRUcmFjZUlkIjpudWxsfSx7InBhcmVudCI6bnVsbCwiZXJyb3JlZCI6ZmFsc2UsInRyYWNlSWQiOjI0LCJuYW1lIjoiMTUiLCJzb3VyY2UiOiIxNiIsImZ1bmN0aW9uQ29kZSI6IjE3IiwibWV0aG9kQ29kZSI6IjciLCJjbGFzc0NvZGUiOiI3IiwiYXJncyI6IjE4IiwiY2hpbGRyZW4iOiIxOSIsImNvbXBsZXRlZCI6dHJ1ZSwiY2hhaW5lZCI6ZmFsc2UsInBhcmVudFRyYWNlSWQiOm51bGwsInJldHVyblZhbHVlIjoyfSwiY2hhaW5lZFRlc3QiLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6NzA6MiIsIihhcnI6IG51bWJlcltdKSA9PiB7XG4gIGFyci5tYXAoKG51bSkgPT4gbnVtICogMikuZmlsdGVyKChudW0pID0+IG51bSA+IDMpO1xufSIsIiIsWyIyMCJdLFsiMjEiLCIyMiJdLCJjbGFzc1Rlc3QiLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6NzE6MiIsIigpID0+IHtcbiAgY29uc3QgdGVzdEluc3RhbmNlID0gbmV3IFRlc3RDbGFzcygpO1xuICB0ZXN0SW5zdGFuY2UudGVzdCgpO1xufSIsW10sWyIyMyIsIjI0Il0sInN5bmNUZXN0IiwiL1VzZXJzL3JhY2dvby9Eb2N1bWVudHMvY2xvbmVUcmFjZXIvc2NyeS9leGFtcGxlcy9icm93c2VyL3NyYy90ZXN0LnRzOjcyOjIiLCIodmFsdWU6IG51bWJlcikgPT4ge1xuICBzeW5jVGVzdDEoXCIxXCIpO1xuICBzeW5jVGVzdDIoXCIyXCIpO1xuICByZXR1cm4gdmFsdWU7XG59IixbMl0sWyIyNSIsIjI2Il0sWzQsNSw2XSx7InBhcmVudCI6IjEiLCJlcnJvcmVkIjpmYWxzZSwidHJhY2VJZCI6MTksIm5hbWUiOiIyNyIsInNvdXJjZSI6IjI4IiwiZnVuY3Rpb25Db2RlIjoiNyIsIm1ldGhvZENvZGUiOiIyOSIsImNsYXNzQ29kZSI6IjI5IiwiYXJncyI6IjMwIiwiY2hpbGRyZW4iOiIzMSIsImNvbXBsZXRlZCI6dHJ1ZSwiY2hhaW5lZCI6ZmFsc2UsInBhcmVudFRyYWNlSWQiOjE3LCJyZXR1cm5WYWx1ZSI6IjMyIiwiY2hhaW5JbmZvIjoiMzMifSx7InBhcmVudCI6IjEiLCJlcnJvcmVkIjpmYWxzZSwidHJhY2VJZCI6MTgsIm5hbWUiOiIzNCIsInNvdXJjZSI6IjI4IiwiZnVuY3Rpb25Db2RlIjoiNyIsIm1ldGhvZENvZGUiOiI3IiwiY2xhc3NDb2RlIjoiNyIsImFyZ3MiOiIzNSIsImNoaWxkcmVuIjoiMzYiLCJjb21wbGV0ZWQiOnRydWUsImNoYWluZWQiOnRydWUsInBhcmVudFRyYWNlSWQiOjE3LCJyZXR1cm5WYWx1ZSI6IjM3IiwiY2hhaW5JbmZvIjoiMzgifSx7InBhcmVudCI6IjIiLCJlcnJvcmVkIjpmYWxzZSwidHJhY2VJZCI6MjEsIm5hbWUiOiIzOSIsInNvdXJjZSI6IjQwIiwiZnVuY3Rpb25Db2RlIjoiNDEiLCJtZXRob2RDb2RlIjoiNyIsImNsYXNzQ29kZSI6IjciLCJhcmdzIjoiNDIiLCJjaGlsZHJlbiI6IjQzIiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6MjAsInJldHVyblZhbHVlIjoiNDQifSx7InBhcmVudCI6IjIiLCJlcnJvcmVkIjpmYWxzZSwidHJhY2VJZCI6MjIsIm5hbWUiOiI0NSIsInNvdXJjZSI6IjQ2IiwiZnVuY3Rpb25Db2RlIjoiNyIsIm1ldGhvZENvZGUiOiI0NyIsImNsYXNzQ29kZSI6IjQxIiwiYXJncyI6IjQ4IiwiY2hpbGRyZW4iOiI0OSIsImNvbXBsZXRlZCI6dHJ1ZSwiY2hhaW5lZCI6ZmFsc2UsInBhcmVudFRyYWNlSWQiOjIwfSx7InBhcmVudCI6IjMiLCJlcnJvcmVkIjpmYWxzZSwidHJhY2VJZCI6MjUsIm5hbWUiOiI1MCIsInNvdXJjZSI6IjUxIiwiZnVuY3Rpb25Db2RlIjoiNTIiLCJtZXRob2RDb2RlIjoiNyIsImNsYXNzQ29kZSI6IjciLCJhcmdzIjoiNTMiLCJjaGlsZHJlbiI6IjU0IiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6MjR9LHsicGFyZW50IjoiMyIsImVycm9yZWQiOmZhbHNlLCJ0cmFjZUlkIjoyNywibmFtZSI6IjU1Iiwic291cmNlIjoiNTYiLCJmdW5jdGlvbkNvZGUiOiI1NyIsIm1ldGhvZENvZGUiOiI3IiwiY2xhc3NDb2RlIjoiNyIsImFyZ3MiOiI1OCIsImNoaWxkcmVuIjoiNTkiLCJjb21wbGV0ZWQiOnRydWUsImNoYWluZWQiOmZhbHNlLCJwYXJlbnRUcmFjZUlkIjoyNH0sIm1hcCIsIi9Vc2Vycy9yYWNnb28vRG9jdW1lbnRzL2Nsb25lVHJhY2VyL3NjcnkvZXhhbXBsZXMvYnJvd3Nlci9zcmMvdGVzdC50czo0NToyIiwiW0V4dGVybmFsIENvZGVdIixbbnVsbF0sW10sWzgsMTAsMTJdLHsic3RhcnRUcmFjZUlkIjoxOSwiaW5kZXgiOjF9LCJmaWx0ZXIiLFtudWxsXSxbXSxbOCwxMCwxMl0seyJzdGFydFRyYWNlSWQiOjE5LCJpbmRleCI6Mn0sIlRlc3RDbGFzcyIsIi9Vc2Vycy9yYWNnb28vRG9jdW1lbnRzL2Nsb25lVHJhY2VyL3NjcnkvZXhhbXBsZXMvYnJvd3Nlci9zcmMvdGVzdC50czo0MDoyMyIsImNsYXNzIFRlc3RDbGFzcyB7XG4gIGNvbnN0cnVjdG9yKCkge31cbiAgdGVzdCgpIHtcbiAgICBjb25zb2xlLmxvZyhcInRlc3RcIik7XG4gIH1cbn0iLFtdLFtdLHt9LCJ0ZXN0IiwiL1VzZXJzL3JhY2dvby9Eb2N1bWVudHMvY2xvbmVUcmFjZXIvc2NyeS9leGFtcGxlcy9icm93c2VyL3NyYy90ZXN0LnRzOjQxOjIiLCJ0ZXN0KCkge1xuICAgIGNvbnNvbGUubG9nKFwidGVzdFwiKTtcbiAgfSIsW10sWyI2MCJdLCJzeW5jVGVzdDEiLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6Mjc6MiIsIih2YWx1ZTogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IHRlc3QgPSB2YWx1ZSArIFwic3luY1Rlc3QxXCI7XG4gIGNvbnNvbGUubG9nKHRlc3QpO1xufSIsWyI2MSJdLFsiNjIiXSwic3luY1Rlc3QyIiwiL1VzZXJzL3JhY2dvby9Eb2N1bWVudHMvY2xvbmVUcmFjZXIvc2NyeS9leGFtcGxlcy9icm93c2VyL3NyYy90ZXN0LnRzOjI4OjIiLCIodmFsdWU6IHN0cmluZykgPT4ge1xuICBjb25zb2xlLmxvZyh2YWx1ZSArIFwic3luY1Rlc3QyXCIpO1xufSIsWyI2MyJdLFsiNjQiXSx7InBhcmVudCI6IjI0IiwiZXJyb3JlZCI6ZmFsc2UsInRyYWNlSWQiOjIzLCJuYW1lIjoiNjUiLCJzb3VyY2UiOiI2NiIsImZ1bmN0aW9uQ29kZSI6IjciLCJtZXRob2RDb2RlIjoiNyIsImNsYXNzQ29kZSI6IjciLCJhcmdzIjoiNjciLCJjaGlsZHJlbiI6IjY4IiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6MjJ9LCIxIix7InBhcmVudCI6IjI1IiwiZXJyb3JlZCI6ZmFsc2UsInRyYWNlSWQiOjI2LCJuYW1lIjoiNjUiLCJzb3VyY2UiOiI2OSIsImZ1bmN0aW9uQ29kZSI6IjciLCJtZXRob2RDb2RlIjoiNyIsImNsYXNzQ29kZSI6IjciLCJhcmdzIjoiNzAiLCJjaGlsZHJlbiI6IjcxIiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6MjV9LCIyIix7InBhcmVudCI6IjI2IiwiZXJyb3JlZCI6ZmFsc2UsInRyYWNlSWQiOjI4LCJuYW1lIjoiNjUiLCJzb3VyY2UiOiI3MiIsImZ1bmN0aW9uQ29kZSI6IjciLCJtZXRob2RDb2RlIjoiNyIsImNsYXNzQ29kZSI6IjciLCJhcmdzIjoiNzMiLCJjaGlsZHJlbiI6Ijc0IiwiY29tcGxldGVkIjp0cnVlLCJjaGFpbmVkIjpmYWxzZSwicGFyZW50VHJhY2VJZCI6Mjd9LCJsb2ciLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6MzU6NCIsWyI0NSJdLFtdLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6MjA6MiIsWyI3NSJdLFtdLCIvVXNlcnMvcmFjZ29vL0RvY3VtZW50cy9jbG9uZVRyYWNlci9zY3J5L2V4YW1wbGVzL2Jyb3dzZXIvc3JjL3Rlc3QudHM6MjM6MiIsWyI3NiJdLFtdLCIxc3luY1Rlc3QxIiwiMnN5bmNUZXN0MiJd";

function useInjectionData() {
  const { deserialize } = useTransformer();
  const [data, setData] = useState<TraceNode[]>([]);
  useLayoutEffect(() => {
    try {
      const deserializedData: TraceNode[] = deserialize(
        dummy
        // window.__INJECTION_DATA__
      );
      setData(deserializedData);
    } catch (error) {
      console.error(error);
    }
  }, []);
  return { data };
}

export { useInjectionData };
